Instructions & Tasks
Acme Anvil Corporation - Load Balancing Containers
In this learning activity, you will load balance containers using two methods. First, you will use Nginx to load balance traffic to three weather-app containers. Next, you will use Docker Swarm to load-balance a pair of Nginx containers.

Log in to Swarm Server 1 and Swarm Server 2 and sudo to root.

Part 1
We will be using Docker Compose to set up the load balancer and containers.

On Swarm Server 1, in the root directory, navigate to lb-challenge and create the Docker Compose file.
Set the Compose version to 3.2.
Create three weather-app services:
  weather-app1
  weather-app2
  weather-app3
The services should build the Dockerfile that is in the weather-app directory.
All three should have tty set to true.
All three containers should be using the frontend network.
Create a service called loadbalancer.
It should use the Dockerfile located in the load-balancer directory.
Set tty to true.
The port mapping should be set to 80 on the host and 80 on the container.
The load balancer should be using the frontend network.
Create the Frontend Network
In the load-balancer directory, there will be a file called nginx.conf.
Add the three weather-app services to the upstream section.
In the server section, make sure it is listening on port 80.
Set the server_name to localhost.
The location should be set to /.
The location should contain a proxy pass to localhost.
The proxy set header should be set to $host.
Execute a compose up and make sure to use the build and detached flags.
Verify that your app is up and running.
Part 2
In the root directory, use cat to retrieve the contents of swarm-token.txt.
Use the docker swarm join --token command from the output of the file to join Swarm Server 2 to the swarm.
Create a service called nginx-app.
The published port should be 8080 and the target port should be 80 on the container.
Make sure there are 2 replicas.
Use the nginx image.
Verify that your app is up and running.
